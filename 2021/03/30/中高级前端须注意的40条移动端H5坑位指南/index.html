<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="中高级前端须注意的40条移动端H5坑位指南"><meta name="keywords" content="JavaScript,Web,ES6,html"><meta name="author" content="Sir_Liu"><meta name="copyright" content="Sir_Liu"><title>中高级前端须注意的40条移动端H5坑位指南 | Coding Your Life</title><link rel="shortcut icon" href="/vite.svg"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Site Name Atom Feed"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4583227810964573" crossorigin="anonymous"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  hexoVersion: '3.9.0'
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#HTML方向"><span class="toc-number">1.</span> <span class="toc-text">HTML方向</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#调用系统功能"><span class="toc-number">1.0.1.</span> <span class="toc-text">调用系统功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#忽略自动识别"><span class="toc-number">1.0.2.</span> <span class="toc-text">忽略自动识别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#弹出数字键盘"><span class="toc-number">1.0.3.</span> <span class="toc-text">弹出数字键盘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#唤醒原生应用"><span class="toc-number">1.0.4.</span> <span class="toc-text">唤醒原生应用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#禁止页面缩放"><span class="toc-number">1.0.5.</span> <span class="toc-text">禁止页面缩放</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#禁止页面缓存"><span class="toc-number">1.0.6.</span> <span class="toc-text">禁止页面缓存</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#禁止字母大写"><span class="toc-number">1.0.7.</span> <span class="toc-text">禁止字母大写</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#针对Safari配置"><span class="toc-number">1.0.8.</span> <span class="toc-text">针对Safari配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#针对其他浏览器配置"><span class="toc-number">1.0.9.</span> <span class="toc-text">针对其他浏览器配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#让-active有效，让-hover无效"><span class="toc-number">1.0.10.</span> <span class="toc-text">让:active有效，让:hover无效</span></a></li></ol></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#CSS方向"><span class="toc-number">2.</span> <span class="toc-text">CSS方向</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#自动适应布局"><span class="toc-number">2.0.1.</span> <span class="toc-text">自动适应布局</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#自动适应背景"><span class="toc-number">2.0.2.</span> <span class="toc-text">自动适应背景</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#监听屏幕旋转"><span class="toc-number">2.0.3.</span> <span class="toc-text">监听屏幕旋转</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#支持弹性滚动"><span class="toc-number">2.0.4.</span> <span class="toc-text">支持弹性滚动</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#禁止滚动传播"><span class="toc-number">2.0.5.</span> <span class="toc-text">禁止滚动传播</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#禁止屏幕抖动"><span class="toc-number">2.0.6.</span> <span class="toc-text">禁止屏幕抖动</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#禁止长按操作"><span class="toc-number">2.0.7.</span> <span class="toc-text">禁止长按操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#禁止字体调整"><span class="toc-number">2.0.8.</span> <span class="toc-text">禁止字体调整</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#禁止高亮显示"><span class="toc-number">2.0.9.</span> <span class="toc-text">禁止高亮显示</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#禁止动画闪屏"><span class="toc-number">2.0.10.</span> <span class="toc-text">禁止动画闪屏</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#美化表单外观"><span class="toc-number">2.0.11.</span> <span class="toc-text">美化表单外观</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#美化滚动占位"><span class="toc-number">2.0.12.</span> <span class="toc-text">美化滚动占位</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#美化输入占位"><span class="toc-number">2.0.13.</span> <span class="toc-text">美化输入占位</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#对齐输入占位"><span class="toc-number">2.0.14.</span> <span class="toc-text">对齐输入占位</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#对齐下拉选项"><span class="toc-number">2.0.15.</span> <span class="toc-text">对齐下拉选项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#修复点击无效"><span class="toc-number">2.0.16.</span> <span class="toc-text">修复点击无效</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#识别文本换行"><span class="toc-number">2.0.17.</span> <span class="toc-text">识别文本换行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#开启硬件加速"><span class="toc-number">2.0.18.</span> <span class="toc-text">开启硬件加速</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#描绘像素边框"><span class="toc-number">2.0.19.</span> <span class="toc-text">描绘像素边框</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#控制溢出文本"><span class="toc-number">2.0.20.</span> <span class="toc-text">控制溢出文本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#js方向"><span class="toc-number">3.</span> <span class="toc-text">js方向</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#支持往返刷新"><span class="toc-number">3.0.1.</span> <span class="toc-text">支持往返刷新</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#简化回到顶部"><span class="toc-number">3.0.2.</span> <span class="toc-text">简化回到顶部</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#简化懒性加载"><span class="toc-number">3.0.3.</span> <span class="toc-text">简化懒性加载</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#优化扫码识别"><span class="toc-number">3.0.4.</span> <span class="toc-text">优化扫码识别</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#文章转自-作者JowayYoung-https-mp-weixin-qq-com-s-nge9FPgVS6FZcuVOTxCBtQ"><span class="toc-number">3.0.4.1.</span> <span class="toc-text">文章转自 作者JowayYoung https://mp.weixin.qq.com/s/nge9FPgVS6FZcuVOTxCBtQ</span></a></li></ol></li></ol></li></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/mirror-assets/16d2a30b4d8e2a895e6~tplv-t2oaga2asx-jj-mark:72:72:0:0:q75.avis"></div><div class="author-info__name text-center">Sir_Liu</div><div class="author-info__description text-center">无论从事什么行业，只要做好两件事就够了，一个是你的专业、一个是你的人品，专业决定了你的存在，人品决定了你的人脉，剩下的就是坚持，用善良專業和真诚赢取更多的信任。（No matter what industry you are in, it is enough to do two things well, one is your profession and the other is your character. Your profession determines your existence, and your character determines your network. The rest is persistence, and you should win more trust with kindness, professionalism and sincerity.）</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">18</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">17</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">10</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(chrome-extension://pkfjcehoipcdbiilobhcblbkmelocaka/start/skin/images/bg-51.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Coding Your Life</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">首页</a><a class="site-page" href="/archives">归档</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/atom.xml">rss</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">中高级前端须注意的40条移动端H5坑位指南</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-03-30</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/前端/">前端</a><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">4.5k</span><span class="post-meta__separator">|</span><span>阅读时长: 16 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p><code>移动端开发在前端里像神一样地存在，不是说它多难而是说它坑位实在太多了，怎样填都填不完。Android和iOS各显神通，Android的系统版本和屏幕分辨率多得难以一招兼容，iOS的顽固标准和未知特性多得难以快速掌握。</code></p>
<p><code>三年半沉淀通过本文记录下所遇到的坑位，或许有些坑位还未遇到，但本文记录的「40条坑位」绝对能让同学们少走很多弯路，特别是前端小白。为了减少废话提高本文质量，对以下内容做一些约定。</code></p>
<h2 id="HTML方向"><a href="#HTML方向" class="headerlink" title="HTML方向"></a>HTML方向</h2><h4 id="调用系统功能"><a href="#调用系统功能" class="headerlink" title="调用系统功能"></a>调用系统功能</h4><p>使用<code>&lt;a&gt;</code>能快速调用移动设备的<code>电话/短信/邮件</code>三大通讯功能，使用<code>&lt;input&gt;</code>能快速调用移动设备的的图库/文件。</p>
<p>这些功能方便了页面与系统的交互，关键在于调用格式一定要准确，否则会被移动端浏览器忽略。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 拨打电话 --&gt;</span><br><span class="line">&lt;a href=<span class="string">"tel:10086"</span>&gt;拨打电话给10086小姐姐&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 发送短信 --&gt;</span><br><span class="line">&lt;a href=<span class="string">"sms:10086"</span>&gt;发送短信给10086小姐姐&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 发送邮件 --&gt;</span><br><span class="line">&lt;a href=<span class="string">"mailto:young.joway@aliyun.com"</span>&gt;发送邮件给JowayYoung&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 选择照片或拍摄照片 --&gt;</span><br><span class="line">&lt;input <span class="built_in">type</span>=<span class="string">"file"</span> accept=<span class="string">"image/*"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 选择视频或拍摄视频 --&gt;</span><br><span class="line">&lt;input <span class="built_in">type</span>=<span class="string">"file"</span> accept=<span class="string">"video/*"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 多选文件 --&gt;</span><br><span class="line">&lt;input <span class="built_in">type</span>=<span class="string">"file"</span> multiple&gt;</span><br></pre></td></tr></table></figure>
<h4 id="忽略自动识别"><a href="#忽略自动识别" class="headerlink" title="忽略自动识别"></a>忽略自动识别</h4><p>有些移动端浏览器会自动将数字字母符号识别为电话/邮箱并将其渲染成上述「调用系统功能」里的<code>&lt;a&gt;</code>。虽然很方便却有可能违背需求。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 忽略自动识别电话 --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"format-detection"</span> content=<span class="string">"telephone=no"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 忽略自动识别邮箱 --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"format-detection"</span> content=<span class="string">"email=no"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 忽略自动识别电话和邮箱 --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"format-detection"</span> content=<span class="string">"telephone=no, email=no"</span>&gt;</span><br></pre></td></tr></table></figure>
<h4 id="弹出数字键盘"><a href="#弹出数字键盘" class="headerlink" title="弹出数字键盘"></a>弹出数字键盘</h4><p>使用<code>&lt;input type=&quot;tel&quot;&gt;</code>弹起数字键盘会带上#和<em>，适合输入电话。推荐使用 `&lt;input type=”number” pattern=”\d</em>“&gt;`弹起数字键盘，适合输入验证码等纯数字格式。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 纯数字带<span class="comment">#和* --&gt;</span></span><br><span class="line">&lt;input <span class="built_in">type</span>=<span class="string">"tel"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 纯数字 --&gt;</span><br><span class="line">&lt;input <span class="built_in">type</span>=<span class="string">"number"</span> pattern=<span class="string">"\d*"</span>&gt;</span><br></pre></td></tr></table></figure>
<h4 id="唤醒原生应用"><a href="#唤醒原生应用" class="headerlink" title="唤醒原生应用"></a>唤醒原生应用</h4><p>通过<code>location.href</code>与原生应用建立通讯渠道，这种页面与客户端的通讯方式称为<code>「URL Scheme」</code>，其基本格式为<code>scheme://[path][?query]</code>，笔者曾经发表过《H5与App的通讯方式》讲述<code>URL Scheme</code>的使用。</p>
<ul>
<li><code>「scheme」</code>：应用标识，表示应用在系统里的唯一标识</li>
<li><code>「path」</code> ：应用行为，表示应用某个页面或功能</li>
<li><code>「query」</code>：应用参数，表示应用页面或应用功能所需的条件参数</li>
</ul>
<p><code>URL Scheme</code>一般由前端与客户端共同协商。唤醒原生应用的前提是必须在移动设备里安装了该应用，有些移动端浏览器即使安装了该应用也无法唤醒原生应用，因为它认为<code>URL Scheme</code>是一种潜在的危险行为而禁用它，像Safari和微信浏览器。还好微信浏览器可开启白名单让<code>URL Scheme</code>有效。</p>
<p>若在页面引用第三方原生应用的<code>URL Schema</code>，可通过抓包第三方原生应用获取其<code>URL</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 打开微信 --&gt;</span><br><span class="line">&lt;a href=<span class="string">"weixin://"</span>&gt;打开微信&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 打开支付宝 --&gt;</span><br><span class="line">&lt;a href=<span class="string">"alipays://"</span>&gt;打开支付宝&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 打开支付宝的扫一扫 --&gt;</span><br><span class="line">&lt;a href=<span class="string">"alipays://platformapi/startapp?saId=10000007"</span>&gt;打开支付宝的扫一扫&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 打开支付宝的蚂蚁森林 --&gt;</span><br><span class="line">&lt;a href=<span class="string">"alipays://platformapi/startapp?appId=60000002"</span>&gt;打开支付宝的蚂蚁森林&lt;/a&gt;</span><br></pre></td></tr></table></figure>
<h4 id="禁止页面缩放"><a href="#禁止页面缩放" class="headerlink" title="禁止页面缩放"></a>禁止页面缩放</h4><p>在智能手机的普及下，很多网站都具备<code>桌面端</code>和<code>移动端</code>两种浏览版本，因此无需双击缩放查看页面。禁止页面缩放可保障<code>移动端</code>浏览器能无遗漏地展现页面所有布局。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, user-scalable=no, initial-scale=1, minimum-scale=1, maximum-scale=1"</span>&gt;</span><br></pre></td></tr></table></figure>
<h4 id="禁止页面缓存"><a href="#禁止页面缓存" class="headerlink" title="禁止页面缓存"></a>禁止页面缓存</h4><p><code>「Cache-Control」</code>指定请求和响应遵循的缓存机制，不想使用浏览器缓存就禁止呗！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta http-equiv=<span class="string">"Cache-Control"</span> content=<span class="string">"no-cache"</span>&gt;</span><br></pre></td></tr></table></figure>
<h4 id="禁止字母大写"><a href="#禁止字母大写" class="headerlink" title="禁止字母大写"></a>禁止字母大写</h4><p>有时在输入框里输入文本会默认开启首字母大写纠正，就是输入首字母小写会被自动纠正成大写，特么的烦。直接声明<code>autocapitalize=off</code>关闭首字母大写功能和<code>autocorrect=off</code>关闭纠正功能。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input autocapitalize=<span class="string">"off"</span> autocorrect=<span class="string">"off"</span>&gt;</span><br></pre></td></tr></table></figure>
<h4 id="针对Safari配置"><a href="#针对Safari配置" class="headerlink" title="针对Safari配置"></a>针对Safari配置</h4><p>贴一些Safari较零散且少用的配置。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 设置Safari全屏，在iOS7+无效 --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"apple-mobile-web-app-capable"</span> content=<span class="string">"yes"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 改变Safari状态栏样式，可选default/black/black-translucent，需在上述全屏模式下才有效 --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"apple-mobile-web-app-status-bar-style"</span> content=<span class="string">"black"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 添加页面启动占位图 --&gt;</span><br><span class="line">&lt;link rel=<span class="string">"apple-touch-startup-image"</span> href=<span class="string">"pig.jpg"</span> media=<span class="string">"(device-width: 375px)"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 保存网站到桌面时添加图标 --&gt;</span><br><span class="line">&lt;link rel=<span class="string">"apple-touch-icon"</span> sizes=<span class="string">"76x76"</span> href=<span class="string">"pig.jpg"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 保存网站到桌面时添加图标且清除默认光泽 --&gt;</span><br><span class="line">&lt;link rel=<span class="string">"apple-touch-icon-precomposed"</span> href=<span class="string">"pig.jpg"</span>&gt;</span><br></pre></td></tr></table></figure>
<h4 id="针对其他浏览器配置"><a href="#针对其他浏览器配置" class="headerlink" title="针对其他浏览器配置"></a>针对其他浏览器配置</h4><p>贴一些其他浏览器较零散且少用的配置，主要是常用的QQ浏览器、UC浏览器和360浏览器。从网易MTL的测试数据得知，新版的QQ浏览器和UC浏览器已不支持以下<code>&lt;meta&gt;</code>声明了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 强制QQ浏览器竖屏 --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"x5-orientation"</span> content=<span class="string">"portrait"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 强制QQ浏览器全屏 --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"x5-fullscreen"</span> content=<span class="string">"true"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 开启QQ浏览器应用模式 --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"x5-page-mode"</span> content=<span class="string">"app"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 强制UC浏览器竖屏 --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"screen-orientation"</span> content=<span class="string">"portrait"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 强制UC浏览器全屏 --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"full-screen"</span> content=<span class="string">"yes"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 开启UC浏览器应用模式 --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"browsermode"</span> content=<span class="string">"application"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 开启360浏览器极速模式 --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"renderer"</span> content=<span class="string">"webkit"</span>&gt;</span><br></pre></td></tr></table></figure>
<h4 id="让-active有效，让-hover无效"><a href="#让-active有效，让-hover无效" class="headerlink" title="让:active有效，让:hover无效"></a>让:active有效，让:hover无效</h4><p>有些元素的:active可能会无效，而元素的:hover在点击后会一直处于点击状态，需点击其他位置才能解除点击状态。给<body>注册一个空的touchstart事件可将两种状态反转。</body></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;body ontouchstart&gt;&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<h2 id="CSS方向"><a href="#CSS方向" class="headerlink" title="CSS方向"></a>CSS方向</h2><h4 id="自动适应布局"><a href="#自动适应布局" class="headerlink" title="自动适应布局"></a>自动适应布局</h4><p>针对移动端，笔者通常会结合JS依据屏幕宽度与设计图宽度的比例动态声明<code>&lt;html&gt;</code>的<code>font-size</code>，以<code>rem</code>为长度单位声明所有节点的几何属性，这样就能做到大部分移动设备的页面兼容，兼容出入较大的地方再通过媒体查询做特别处理。</p>
<p>笔者通常将rem布局比例设置成1rem=100px，即在设计图上100px长度在CSS代码上使用1rem表示。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">function</span> AutoResponse(width = 750) &#123;</span><br><span class="line">    const target = document.documentElement;</span><br><span class="line">    <span class="keyword">if</span> (target.clientWidth &gt;= 600) &#123;</span><br><span class="line">        target.style.fontSize = <span class="string">"80px"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        target.style.fontSize = target.clientWidth / width * 100 + <span class="string">"px"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">AutoResponse();</span><br><span class="line">window.addEventListener(<span class="string">"resize"</span>, () =&gt; AutoResponse());</span><br></pre></td></tr></table></figure>
<p>当然还可依据屏幕宽度与设计图宽度的比例使用<code>calc()</code>动态声明<code>&lt;html&gt;</code>的<code>font-size</code>，这样就能节省上述代码。不对，是完全代替上述代码。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">html &#123;</span><br><span class="line">    font-size: calc(100vw / 7.5);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>若以iPad Pro分辨率1024px为移动端和桌面端的断点，还可结合媒体查询做断点处理。1024px以下使用rem布局，否则不使用rem布局。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@media screen and (max-width: 1024px) &#123;</span><br><span class="line">    html &#123;</span><br><span class="line">        font-size: calc(100vw / 7.5);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="自动适应背景"><a href="#自动适应背景" class="headerlink" title="自动适应背景"></a>自动适应背景</h4><p>使用rem布局声明一个元素背景，多数情况会将background-size声明为cover。可能在设计图对应分辨率的移动设备下，背景会完美贴合显示，但换到其他分辨率的移动设备下就会出现左右空出1px到npx的空隙。</p>
<p>此时将background-size声明为100% 100%，跟随width和height的变化而变化。反正width和height都是量好的实际尺寸。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.elem &#123;</span><br><span class="line">    width: 1rem;</span><br><span class="line">    height: 1rem;</span><br><span class="line">    background: url(<span class="string">"pig.jpg"</span>) no-repeat center/100% 100%;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="监听屏幕旋转"><a href="#监听屏幕旋转" class="headerlink" title="监听屏幕旋转"></a>监听屏幕旋转</h4><p>你还在使用JS判断横屏竖屏调整样式吗？那就真的Out了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">/* 竖屏 */</span><br><span class="line">@media all and (orientation: portrait) &#123;</span><br><span class="line">    /* 自定义样式 */</span><br><span class="line">&#125;</span><br><span class="line">/* 横屏 */</span><br><span class="line">@media all and (orientation: landscape) &#123;</span><br><span class="line">    /* 自定义样式 */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="支持弹性滚动"><a href="#支持弹性滚动" class="headerlink" title="支持弹性滚动"></a>支持弹性滚动</h4><p>在苹果系统上非<code>&lt;body&gt;</code>元素的滚动操作可能会存在卡顿，但安卓系统不会出现该情况。通过声明<code>overflow-scrolling:touch</code>调用系统原生滚动事件优化弹性滚动，增加页面滚动的流畅度。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">body &#123;</span><br><span class="line">    -webkit-overflow-scrolling: touch;</span><br><span class="line">&#125;</span><br><span class="line">.elem &#123;</span><br><span class="line">    overflow: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="禁止滚动传播"><a href="#禁止滚动传播" class="headerlink" title="禁止滚动传播"></a>禁止滚动传播</h4><p>与桌面端浏览器不一样，移动端浏览器有一个奇怪行为。当页面包含多个滚动区域时，滚完一个区域后若还存在滚动动量则会将这些剩余动量传播到下一个滚动区域，造成该区域也滚动起来。这种行为称为<code>「滚动传播」</code>。</p>
<p>若不想产生这种奇怪行为可直接禁止。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.elem &#123;</span><br><span class="line">    overscroll-behavior: contain;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="禁止屏幕抖动"><a href="#禁止屏幕抖动" class="headerlink" title="禁止屏幕抖动"></a>禁止屏幕抖动</h4><p>对于一些突然出现滚动条的页面，可能会产生左右抖动的不良影响。在一个滚动容器里，打开弹窗就隐藏滚动条，关闭弹窗就显示滚动条，来回操作会让屏幕抖动起来。提前声明滚动容器的padding-right为滚动条宽度，就能有效消除这个不良影响。</p>
<p>每个移动端浏览器的滚动条宽度都有可能不一致，甚至不一定占位置，通过以下方式能间接计算出滚动条的宽度。100vw为视窗宽度，100%为滚动容器内容宽度，相减就是滚动条宽度，妥妥的动态计算。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">body &#123;</span><br><span class="line">    padding-right: calc(100vw - 100%);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="禁止长按操作"><a href="#禁止长按操作" class="headerlink" title="禁止长按操作"></a>禁止长按操作</h4><p>有时不想用户长按元素呼出菜单进行点链接、打电话、发邮件、保存图片或扫描二维码等操作，声明<code>touch-callout:none</code>禁止用户长按操作。</p>
<p>有时不想用户复制粘贴盗文案，声明<code>user-select:none</code>禁止用户长按操作和选择复制。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">    /* pointer-events: none; */ /* 微信浏览器还需附加该属性才有效 */</span><br><span class="line">    user-select: none; /* 禁止长按选择文字 */</span><br><span class="line">    -webkit-touch-callout: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但声明user-select:none会让<code>&lt;input&gt;</code>和<code>&lt;textarea&gt;</code>无法输入文本，可对其声明<code>user-select:auto</code>排除在外。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">input,</span><br><span class="line">textarea &#123;</span><br><span class="line">    user-select: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="禁止字体调整"><a href="#禁止字体调整" class="headerlink" title="禁止字体调整"></a>禁止字体调整</h4><p>旋转屏幕可能会改变字体大小，声明text-size-adjust:100%让字体大小保持不变。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">    text-size-adjust: 100%;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="禁止高亮显示"><a href="#禁止高亮显示" class="headerlink" title="禁止高亮显示"></a>禁止高亮显示</h4><p>触摸元素会出现半透明灰色遮罩，不想要！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">    -webkit-tap-highlight-color: transparent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="禁止动画闪屏"><a href="#禁止动画闪屏" class="headerlink" title="禁止动画闪屏"></a>禁止动画闪屏</h4><p>在移动设备上添加动画，多数情况会出现闪屏，给动画元素的父元素构造一个3D环境就能让动画稳定运行了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">.elem &#123;</span><br><span class="line">    perspective: 1000;</span><br><span class="line">    backface-visibility: hidden;</span><br><span class="line">    transform-style: preserve-3d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="美化表单外观"><a href="#美化表单外观" class="headerlink" title="美化表单外观"></a>美化表单外观</h4><p>表单元素样式太丑希望自定义，appearance:none来帮你。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">button,</span><br><span class="line">input,</span><br><span class="line">select,</span><br><span class="line">textarea &#123;</span><br><span class="line">    appearance: none;</span><br><span class="line">    /* 自定义样式 */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="美化滚动占位"><a href="#美化滚动占位" class="headerlink" title="美化滚动占位"></a>美化滚动占位</h4><p>滚动条样式太丑希望自定义，<code>::-webkit-scrollbar-*</code>来帮你。记住以下三个关键词就能随机应变了。</p>
<ul>
<li style="list-style: none"><input type="checkbox" checked> 「::-webkit-scrollbar」：滚动条整体部分</li>
<li style="list-style: none"><input type="checkbox" checked> 「::-webkit-scrollbar-track」：滚动条轨道部分</li>
<li style="list-style: none"><input type="checkbox" checked> 「::-webkit-scrollbar-thumb」：滚动条滑块部分</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">::-webkit-scrollbar &#123;</span><br><span class="line">    width: 6px;</span><br><span class="line">    height: 6px;</span><br><span class="line">    background-color: transparent;</span><br><span class="line">&#125;</span><br><span class="line">::-webkit-scrollbar-track &#123;</span><br><span class="line">    background-color: transparent;</span><br><span class="line">&#125;</span><br><span class="line">::-webkit-scrollbar-thumb &#123;</span><br><span class="line">    border-radius: 3px;</span><br><span class="line">    background-image: linear-gradient(135deg, <span class="comment">#09f, #3c9);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="美化输入占位"><a href="#美化输入占位" class="headerlink" title="美化输入占位"></a>美化输入占位</h4><p>输入框占位文本太丑，<code>::-webkit-input-placeholder</code>来帮你。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">input::-webkit-input-placeholder &#123;</span><br><span class="line">    color: <span class="comment">#66f;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="对齐输入占位"><a href="#对齐输入占位" class="headerlink" title="对齐输入占位"></a>对齐输入占位</h4><p>有强迫症的同学总会觉得输入框文本位置整体偏上，感觉未居中心里就痒痒的。桌面端浏览器里声明<code>line-height</code>等于<code>height</code>就能解决，但移动端浏览器里还是未能解决，需将<code>line-height</code>声明为<code>normal</code>才行。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">input &#123;</span><br><span class="line">    line-height: normal;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="对齐下拉选项"><a href="#对齐下拉选项" class="headerlink" title="对齐下拉选项"></a>对齐下拉选项</h4><p>下拉框选项默认向左对齐，是时候改改向右对齐了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select option &#123;</span><br><span class="line">    direction: rtl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="修复点击无效"><a href="#修复点击无效" class="headerlink" title="修复点击无效"></a>修复点击无效</h4><p>在苹果系统上有些情况下非可点击元素监听<code>click</code>事件可能会无效，针对该情况只需对不触发<code>click</code>事件的元素声明<code>cursor:pointer</code>就能解决。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.elem &#123;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="识别文本换行"><a href="#识别文本换行" class="headerlink" title="识别文本换行"></a>识别文本换行</h4><p>多数情况会使用<code>JS</code>换行文本，那就真的<code>Out</code>了。若接口返回字段包含<code>\n</code>或<code>&lt;br&gt;</code>，千万别替换掉，可声明<code>white-space:pre-line</code>交由浏览器做断行处理。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">    white-space: pre-line;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="开启硬件加速"><a href="#开启硬件加速" class="headerlink" title="开启硬件加速"></a>开启硬件加速</h4><p>想动画更流畅吗，开启GPU硬件加速呗！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.elem &#123;</span><br><span class="line">    transform: translate3d(0, 0, 0);</span><br><span class="line">    /* transform: translateZ(0); */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="描绘像素边框"><a href="#描绘像素边框" class="headerlink" title="描绘像素边框"></a>描绘像素边框</h4><p>万年话题，如何描绘一像素边框？</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">.elem &#123;</span><br><span class="line">    position: relative;</span><br><span class="line">    width: 200px;</span><br><span class="line">    height: 80px;</span><br><span class="line">    &amp;::after &#123;</span><br><span class="line">        position: absolute;</span><br><span class="line">        left: 0;</span><br><span class="line">        top: 0;</span><br><span class="line">        border: 1px solid <span class="comment">#f66;</span></span><br><span class="line">        width: 200%;</span><br><span class="line">        height: 200%;</span><br><span class="line">        content: <span class="string">""</span>;</span><br><span class="line">        transform: scale(.5);</span><br><span class="line">        transform-origin: left top;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="控制溢出文本"><a href="#控制溢出文本" class="headerlink" title="控制溢出文本"></a>控制溢出文本</h4><p>万年话题，如何控制文本做单行溢出和多行溢出？</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">.elem &#123;</span><br><span class="line">    width: 400px;</span><br><span class="line">    line-height: 30px;</span><br><span class="line">    font-size: 20px;</span><br><span class="line">    &amp;.sl-ellipsis &#123;</span><br><span class="line">        overflow: hidden;</span><br><span class="line">        text-overflow: ellipsis;</span><br><span class="line">        white-space: nowrap;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;.ml-ellipsis &#123;</span><br><span class="line">        display: -webkit-box;</span><br><span class="line">        overflow: hidden;</span><br><span class="line">        text-overflow: ellipsis;</span><br><span class="line">        -webkit-line-clamp: 3;</span><br><span class="line">        -webkit-box-orient: vertical;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="js方向"><a href="#js方向" class="headerlink" title="js方向"></a>js方向</h2><h4 id="支持往返刷新"><a href="#支持往返刷新" class="headerlink" title="支持往返刷新"></a>支持往返刷新</h4><p>点击移动端浏览器的前进按钮或后退按钮，有时不会自动执行旧页面的JS代码，这与往返缓存有关。这种情况在<code>Safari</code>上特别明显，简单概括就是往返页面无法刷新。<br><code>pageshow</code>事件在每次页面加载时都会触发，无论是首次加载还是再次加载都会触发，这就是它与<code>load</code>事件的区别。<code>pageshow</code>事件暴露的<code>persisted</code>可判断页面是否从<code>BFCache</code>里取出。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.addEventListener(<span class="string">"pageshow"</span>, e =&gt; e.persisted &amp;&amp; location.reload());</span><br></pre></td></tr></table></figure>
<h4 id="简化回到顶部"><a href="#简化回到顶部" class="headerlink" title="简化回到顶部"></a>简化回到顶部</h4><p>曾几何时编写一个返回顶部函数麻烦得要死，需<code>scrollTop</code>、<code>定时器</code>和<code>条件判断</code>三者配合才能完成。其实<code>DOM</code>对象里隐藏了一个很好用的函数可完成上述功能，一行核心代码就能搞定。</p>
<p>该函数就是<code>scrollIntoView</code>，它会滚动目标元素的父容器使之对用户可见，简单概括就是相对视窗让容器滚动到目标元素位置。它有三个可选参数能让<code>scrollIntoView</code>滚动起来更优雅。</p>
<ul>
<li style="list-style: none"><input type="checkbox" checked> <code>「behavior」</code>：动画过渡效果，默认<code>auto</code>无，可选<code>smooth</code>平滑</li>
<li style="list-style: none"><input type="checkbox" checked> <code>「inline」</code>：水平方向对齐方式，默认<code>nearest</code>就近对齐，可选<code>start</code>顶部对齐、<code>center</code>中间对齐和<code>end</code>底部对齐</li>
<li style="list-style: none"><input type="checkbox" checked> <code>「block」</code>：垂直方向对齐方式，默认<code>start</code>顶部对齐，可选<code>center</code>中间对齐、<code>end</code>底部对齐和<code>nearest</code>就近对齐</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const gotopBtn = document.getElementById(<span class="string">"gotop-btn"</span>);</span><br><span class="line">openBtn.addEventListener(<span class="string">"click"</span>, () =&gt; document.body.scrollIntoView(&#123; behavior: <span class="string">"smooth"</span> &#125;));</span><br></pre></td></tr></table></figure>
<h4 id="简化懒性加载"><a href="#简化懒性加载" class="headerlink" title="简化懒性加载"></a>简化懒性加载</h4><p>与上述「简化回到顶部」一样，编写一个懒性加载函数也同样需<code>scrollTop</code>、定时器和条件判断三者配合才能完成。其实<code>DOM</code>对象里隐藏了一个很好用的函数可完成上述功能，该函数无需监听容器的<code>scroll</code>事件，通过浏览器自身机制完成滚动监听。</p>
<p>该函数就是<code>IntersectionObserver</code>，它提供一种异步观察目标元素及其祖先元素或顶级文档视窗交叉状态的方法。详情可参照MDN文档，在此不作过多介绍。</p>
<p>懒性加载的第一种使用场景：<code>「图片懒加载」</code>。只需确认图片进入可视区域就赋值加载图片，赋值完成还需对图片停止监听。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">const imgs = document.querySelectorAll(<span class="string">"img.lazyload"</span>);</span><br><span class="line">const observer = new IntersectionObserver(nodes =&gt; &#123;</span><br><span class="line">    nodes.forEach(v =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (v.isIntersecting) &#123; // 判断是否进入可视区域</span><br><span class="line">            v.target.src = v.target.dataset.src; // 赋值加载图片</span><br><span class="line">            observer.unobserve(v.target); // 停止监听已加载的图片</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">imgs.forEach(v =&gt; observer.observe(v));</span><br></pre></td></tr></table></figure>
<p>懒性加载的第二种使用场景：「下拉加载」。在列表最底部部署一个占位元素且该元素无任何高度或实体外观，只需确认占位元素进入可视区域就请求接口加载数据。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">    &lt;li&gt;&lt;/li&gt;</span><br><span class="line">    &lt;!-- 很多&lt;li&gt; --&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line">&lt;!-- 也可将<span class="comment">#bottom以&lt;li&gt;的形式插入到&lt;ul&gt;内部的最后位置 --&gt;</span></span><br><span class="line">&lt;div id=<span class="string">"bottom"</span>&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">const bottom = document.getElementById(<span class="string">"bottom"</span>);</span><br><span class="line">const observer = new IntersectionObserver(nodes =&gt; &#123;</span><br><span class="line">    const tgt = nodes[0]; // 反正只有一个</span><br><span class="line">    <span class="keyword">if</span> (tgt.isIntersecting) &#123;</span><br><span class="line">        console.log(<span class="string">"已到底部，请求接口"</span>);</span><br><span class="line">        // 执行接口请求代码</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">bottom.observe(bottom);</span><br></pre></td></tr></table></figure>
<h4 id="优化扫码识别"><a href="#优化扫码识别" class="headerlink" title="优化扫码识别"></a>优化扫码识别</h4><p>通常移动端浏览器都会配备长按二维码图片识别链接的功能，但长按二维码可能无法识别或错误识别。二维码表面看上去是一张图片，可二维码生成方式却五花八门，二维码生成方式有以下三种。</p>
<ul>
<li style="list-style: none"><input type="checkbox" checked> 使用<code>&lt;img&gt;</code>渲染</li>
<li style="list-style: none"><input type="checkbox" checked> 使用<code>&lt;svg&gt;</code>渲染</li>
<li style="list-style: none"><input type="checkbox" checked> 使用<code>&lt;canvas&gt;</code>渲染</li>
</ul>
<p>从网易MTL的测试数据得知，大部分移动端浏览器只能识别<code>&lt;img&gt;</code>渲染的二维码，为了让全部移动端浏览器都能识别二维码，那只能使用<code>&lt;img&gt;</code>渲染二维码了。若使用<code>SVG和Canvas</code>的方式生成二维码，那就想方设法把二维码数据转换成Base64再赋值到<code>&lt;img&gt;</code>的<code>src</code>上。</p>
<p>一个页面可能存在多个二维码，若长按二维码只能识别最后一个，那只能控制每个页面只存在一个二维码。</p>
<h5 id="文章转自-作者JowayYoung-https-mp-weixin-qq-com-s-nge9FPgVS6FZcuVOTxCBtQ"><a href="#文章转自-作者JowayYoung-https-mp-weixin-qq-com-s-nge9FPgVS6FZcuVOTxCBtQ" class="headerlink" title="文章转自 作者JowayYoung https://mp.weixin.qq.com/s/nge9FPgVS6FZcuVOTxCBtQ"></a>文章转自 作者JowayYoung <a href="https://mp.weixin.qq.com/s/nge9FPgVS6FZcuVOTxCBtQ" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/nge9FPgVS6FZcuVOTxCBtQ</a></h5></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Sir_Liu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://gofugui.github.io/2021/03/30/中高级前端须注意的40条移动端H5坑位指南/">https://gofugui.github.io/2021/03/30/中高级前端须注意的40条移动端H5坑位指南/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://gofugui.github.io">Coding Your Life</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/JavaScript/">JavaScript</a><a class="post-meta__tags" href="/tags/Web/">Web</a><a class="post-meta__tags" href="/tags/ES6/">ES6</a><a class="post-meta__tags" href="/tags/html/">html</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2021/04/08/前端基础概念/"><i class="fa fa-chevron-left">  </i><span>前端基础概念</span></a></div><div class="next-post pull-right"><a href="/2019/11/12/code-push/"><span>react-native-code-push 热更新配置</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: 'Ov23liqBpY9MxdjqDFTA',
  clientSecret: 'c824e3fe864528851e7734e9f4661a8fd108b390',
  repo: 'gofugui.github.io',
  owner: 'gofugui',
  admin: 'gofugui',
  id: md5(decodeURI(location.pathname)),
  language: 'zh-CN'
})
gitalk.render('gitalk-container')</script></div></div><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4583227810964573" data-ad-slot="8925032663" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});
</script><footer class="footer-bg" style="background-image: url(chrome-extension://pkfjcehoipcdbiilobhcblbkmelocaka/start/skin/images/bg-51.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2025 By Sir_Liu</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script> <script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>